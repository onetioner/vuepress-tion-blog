<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>05-大数据技术之Hadoop（Yarn）V3.3 | Onetion blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/vuepress-tion-blog/img/favicon.ico">
    <meta name="description" content="暂无描述。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/vuepress-tion-blog/assets/css/0.styles.e8f25b53.css" as="style"><link rel="preload" href="/vuepress-tion-blog/assets/js/app.985e0c44.js" as="script"><link rel="preload" href="/vuepress-tion-blog/assets/js/2.1e9277be.js" as="script"><link rel="preload" href="/vuepress-tion-blog/assets/js/103.9c535674.js" as="script"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/10.d8aaa1e2.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/100.573bf337.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/101.d7a8d195.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/102.fbe95517.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/104.32351bcc.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/105.b6592589.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/106.8d41efa5.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/107.81a457e6.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/108.8ec864e5.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/109.51239835.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/11.a042cecb.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/110.cacfe028.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/111.0c6750bc.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/112.10684042.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/113.9f9d8990.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/114.f63027de.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/115.f2a98bd3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/116.1596b700.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/117.7474ad53.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/118.75dfe374.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/119.69b852f5.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/12.b59eab1d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/120.21dce642.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/121.6383cf7a.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/122.aecc2d6d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/123.8e4b47dc.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/124.ebeb3341.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/125.d30e0414.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/126.88154b46.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/127.f11c43ad.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/128.d2af5d75.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/129.4ec987d8.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/13.a5c5a2c7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/130.852e041a.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/131.a2838818.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/132.e76fcb34.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/133.576684f3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/134.b610dab9.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/135.6ddc8624.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/136.169f274d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/137.bc17c8fb.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/138.613e8ec5.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/139.a5f28e09.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/14.d548163d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/140.6f0e2449.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/141.25fa2479.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/142.dbbf3675.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/143.50d1c2c7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/144.ba7322be.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/145.9b01e005.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/146.a3b7fa06.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/147.10ebf0da.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/148.f1813bc1.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/149.558a4638.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/15.9cd1a424.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/150.9fb25f94.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/151.7aa93b4c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/152.532b2a06.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/153.b44e17d2.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/154.22bb2b40.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/155.72912290.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/156.8fb9164a.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/157.2993ac86.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/158.941ffddc.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/159.9949acea.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/16.0c491dca.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/160.b0734e8c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/161.64295a7b.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/162.af6a1a02.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/163.8a084ab0.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/164.b3a5ce11.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/165.006ba217.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/166.8673b3eb.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/167.174f47d0.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/168.ab558478.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/169.2924afe0.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/17.bc0ce024.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/170.938fb8fd.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/171.dba8105e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/172.3ed2b9da.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/173.21e26430.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/174.cf558b90.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/175.e2dbf973.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/176.99fdd868.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/177.b749e041.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/178.50873a04.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/179.2b2b20b8.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/18.3daae30f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/180.e02057f8.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/181.4db698f3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/182.5f8824c7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/183.6edf3c7c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/184.1bd636af.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/185.36ff0829.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/186.5cf6e096.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/187.a5a1b8ff.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/188.afbe2342.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/189.03172795.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/19.3baab1b3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/190.cdbd5be0.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/191.f0b571be.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/192.b17d8025.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/193.71f932fa.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/194.8c1effb7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/195.97749178.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/196.1c2212a2.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/197.b11aec90.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/198.c944c329.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/199.89d6fb24.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/20.04915620.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/200.1f73ae03.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/201.a76ba977.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/202.6506ac4e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/203.58b5a385.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/204.5c93632e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/205.266be28d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/206.8351bc41.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/207.6c3f0adc.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/208.98b8311d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/209.c7197c50.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/21.612e714c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/210.85568730.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/211.57ca633f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/22.73e68385.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/23.e2dc9896.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/24.dd12884f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/25.1657ab7c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/26.fa7585ce.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/27.a745f91e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/28.9fd9565c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/29.4a93ed10.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/3.e80e214b.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/30.48d9f0d9.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/31.d1533b42.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/32.577b9985.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/33.804f824e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/34.6673d1e7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/35.467aab87.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/36.1ff1934f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/37.94917ddd.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/38.267be9e6.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/39.6db92b69.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/4.5c19aee3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/40.4baf779a.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/41.d1f2437d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/42.7abdd1fb.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/43.daec0261.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/44.e62a9c60.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/45.2d73beaf.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/46.96498038.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/47.84482418.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/48.ec50c17c.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/49.865f9ad3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/5.9fe40e58.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/50.6bccd4b4.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/51.2f1f7e9d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/52.53c5b275.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/53.648f4af7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/54.a8f675df.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/55.857005bf.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/56.21b8b93d.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/57.4267e8e7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/58.6f22a666.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/59.7ce4c5d3.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/6.7a1e80d8.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/60.bb4d7708.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/61.3ae45564.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/62.36c8a921.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/63.0cf0550f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/64.c236b268.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/65.3dd549de.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/66.132faef6.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/67.02c3c837.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/68.38da0121.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/69.cfea652f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/7.e4a9cefa.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/70.115de5a1.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/71.2c0ab68b.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/72.6150c1bb.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/73.485cff3f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/74.c0d67eb7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/75.207d3d40.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/76.c4152b85.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/77.fd3d4523.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/78.fb0e3bfd.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/79.0c70e8a7.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/8.1c6e1779.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/80.8d44c6b0.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/81.3764c177.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/82.43478cb4.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/83.c46fe3ff.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/84.aed40128.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/85.9f8f2508.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/86.d250fe69.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/87.c7dfc942.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/88.0ac96029.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/89.5d8f5e20.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/9.4da03d4f.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/90.054f7950.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/91.e05ad0c1.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/92.52f350fe.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/93.26b6b24e.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/94.99e6ce73.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/95.ea8c8ea4.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/96.98e7d194.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/97.14c4ed1b.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/98.f5cdc1ab.js"><link rel="prefetch" href="/vuepress-tion-blog/assets/js/99.f92a6d95.js">
    <link rel="stylesheet" href="/vuepress-tion-blog/assets/css/0.styles.e8f25b53.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-tion-blog/" class="home-link router-link-active"><img src="/vuepress-tion-blog/img/logo.png" alt="Onetion blog" class="logo"> <span class="site-name can-hide">Onetion blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-tion-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档中心" class="dropdown-title"><a href="/vuepress-tion-blog/learn/" class="link-title">文档中心</a> <span class="title" style="display:none;">文档中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-tion-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/javase/" class="nav-link">《JavaSE笔记》</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/javaweb/" class="nav-link">《JavaWeb》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/maven/" class="nav-link">《Maven》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/git/" class="nav-link">《Git》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/ssm/" class="nav-link">《SSM》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/mybatisplus/" class="nav-link">《MybatisPlus》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/reggietakeout/" class="nav-link">《ReggieTakeOut》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/microservice/" class="nav-link">《MicroService》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/xuechengplus/" class="nav-link">《XueChengPlus》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/flume/" class="nav-link">《Flume》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/python/" class="nav-link">《Python》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/scala/" class="nav-link">《Scala》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/linux/" class="nav-link">《Linux》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/hadoop/" class="nav-link">《Hadoop》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/designpatterns/" class="nav-link">《Java设计模式》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/htmlcssweb/" class="nav-link">《HTML-CSS-WEB》笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/vuepress-tion-blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vuepress-tion-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vuepress-tion-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-tion-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuepress-tion-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress-tion-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://jsd.cdn.zzko.cn/gh/xugaoyi/image_store/blog/20200103123203.jpg"> <div class="blogger-info"><h3>Evan Xu</h3> <span>前端界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/vuepress-tion-blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档中心" class="dropdown-title"><a href="/vuepress-tion-blog/learn/" class="link-title">文档中心</a> <span class="title" style="display:none;">文档中心</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-tion-blog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/javase/" class="nav-link">《JavaSE笔记》</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/javaweb/" class="nav-link">《JavaWeb》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/maven/" class="nav-link">《Maven》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/git/" class="nav-link">《Git》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/ssm/" class="nav-link">《SSM》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/mybatisplus/" class="nav-link">《MybatisPlus》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/reggietakeout/" class="nav-link">《ReggieTakeOut》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/microservice/" class="nav-link">《MicroService》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/xuechengplus/" class="nav-link">《XueChengPlus》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/flume/" class="nav-link">《Flume》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/python/" class="nav-link">《Python》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/scala/" class="nav-link">《Scala》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/linux/" class="nav-link">《Linux》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/hadoop/" class="nav-link">《Hadoop》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/designpatterns/" class="nav-link">《Java设计模式》笔记</a></li><li class="dropdown-subitem"><a href="/vuepress-tion-blog/note/htmlcssweb/" class="nav-link">《HTML-CSS-WEB》笔记</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/vuepress-tion-blog/ui/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vuepress-tion-blog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/9a7ee40fc232253e/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vuepress-tion-blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-tion-blog/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/vuepress-tion-blog/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress-tion-blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress-tion-blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/vuepress-tion-blog/pages/a0498b/" class="sidebar-link">01-大数据技术之大数据概论</a></li><li><a href="/vuepress-tion-blog/pages/7421fd/" class="sidebar-link">02-大数据技术之Hadoop（入门）V3.3</a></li><li><a href="/vuepress-tion-blog/pages/802389/" class="sidebar-link">03-大数据技术之Hadoop（HDFS）V3.3</a></li><li><a href="/vuepress-tion-blog/pages/f16deb/" class="sidebar-link">04-大数据技术之Hadoop（MapReduce）V3.3</a></li><li><a href="/vuepress-tion-blog/pages/31d7dd/" aria-current="page" class="active sidebar-link">05-大数据技术之Hadoop（Yarn）V3.3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-1-yarn-基础架构" class="sidebar-link">1.1 Yarn 基础架构</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-2-yarn-工作机制" class="sidebar-link">1.2 Yarn 工作机制</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-3-作业提交全过程" class="sidebar-link">1.3 作业提交全过程</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-4-yarn-调度器和调度算法" class="sidebar-link">1.4 Yarn 调度器和调度算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-4-1-先进先出调度器-fifo" class="sidebar-link">1.4.1 先进先出调度器（FIFO）</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-4-2-容量调度器-capacity-scheduler" class="sidebar-link">1.4.2 容量调度器（Capacity Scheduler）</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-4-3-公平调度器-fair-scheduler" class="sidebar-link">1.4.3 公平调度器（Fair Scheduler）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-yarn-常用命令" class="sidebar-link">1.5 Yarn 常用命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-1-yarn-application-查看任务" class="sidebar-link">1.5.1 yarn application 查看任务</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-2-yarn-logs-查看日志" class="sidebar-link">1.5.2 yarn logs 查看日志</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-3-yarn-applicationattempt-查看尝试运行的任务" class="sidebar-link">1.5.3 yarn applicationattempt 查看尝试运行的任务</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-4-yarn-container-查看容器" class="sidebar-link">1.5.4 yarn container 查看容器</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-5-yarn-node-查看节点状态" class="sidebar-link">1.5.5 yarn node 查看节点状态</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-6-yarn-rmadmin-更新配置" class="sidebar-link">1.5.6 yarn rmadmin 更新配置</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-5-7-yarn-queue-查看队列" class="sidebar-link">1.5.7 yarn queue 查看队列</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_1-6-yarn-生产环境核心参数" class="sidebar-link">1.6 Yarn 生产环境核心参数</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-1-yarn-生产环境核心参数配置案例" class="sidebar-link">2.1 Yarn 生产环境核心参数配置案例</a></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-2-容量调度器多队列提交案例" class="sidebar-link">2.2 容量调度器多队列提交案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-2-1-需求" class="sidebar-link">2.2.1 需求</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-2-2-配置多队列的容量调度器" class="sidebar-link">2.2.2 配置多队列的容量调度器</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-2-3-向-hive-队列提交任务" class="sidebar-link">2.2.3 向 Hive 队列提交任务</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-2-4-任务优先级" class="sidebar-link">2.2.4 任务优先级</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-3-公平调度器案例" class="sidebar-link">2.3 公平调度器案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-3-1-需求" class="sidebar-link">2.3.1 需求</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-3-2-配置多队列的公平调度器" class="sidebar-link">2.3.2 配置多队列的公平调度器</a></li><li class="sidebar-sub-header level3"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-3-3-测试提交任务" class="sidebar-link">2.3.3 测试提交任务</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/vuepress-tion-blog/pages/31d7dd/#_2-4-yarn-的-tool-接口案例" class="sidebar-link">2.4 Yarn 的 Tool 接口案例</a></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/vuepress-tion-blog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/vuepress-tion-blog/note/hadoop/#《Hadoop》笔记" data-v-06225672>《Hadoop》笔记</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/onetioner" target="_blank" title="作者" class="beLink" data-v-06225672>onetion</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2025-02-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">05-大数据技术之Hadoop（Yarn）V3.3<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="尚硅谷大数据技术之-hadoop-yarn"><a href="#尚硅谷大数据技术之-hadoop-yarn" class="header-anchor">#</a> 尚硅谷大数据技术之 Hadoop（Yarn）</h1> <p>版本：V3.3</p> <p>第 <strong>1</strong> 章 <strong>Yarn</strong> 资源调度器</p> <p>思考：</p> <p>1）如何管理集群资源？</p> <p>2）如何给任务合理分配资源？</p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242108729.png" alt="image-20250224210802685"></p> <p>Yarn 是一个资源调度平台，负责为运算程序提供服务器运算资源，相当于一个分布式的操作系统平台，而MapReduce 等运算程序则相当于运行于操作系统之上的应用程序。</p> <h2 id="_1-1-yarn-基础架构"><a href="#_1-1-yarn-基础架构" class="header-anchor">#</a> 1.1 Yarn 基础架构</h2> <p>YARN 主要由 ResourceManager、NodeManager、ApplicationMaster 和 Container 等组件构成。</p> <p><strong>YARN基础架构</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242109238.png" alt="image-20250224210904207"></p> <h2 id="_1-2-yarn-工作机制"><a href="#_1-2-yarn-工作机制" class="header-anchor">#</a> 1.2 Yarn 工作机制</h2> <p><strong>YARN工作机制</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242109225.png" alt="image-20250224210950195"></p> <p>（1）MR 程序提交到客户端所在的节点。</p> <p>（2）YarnRunner 向ResourceManager 申请一个Application。</p> <p>（3）RM 将该应用程序的资源路径返回给YarnRunner。</p> <p>（4）该程序将运行所需资源提交到HDFS 上。</p> <p>（5）程序资源提交完毕后，申请运行 mrAppMaster。</p> <p>（6）RM 将用户的请求初始化成一个 Task。</p> <p>（7）其中一个NodeManager 领取到 Task 任务。</p> <p>（8）该NodeManager 创建容器Container，并产生MRAppmaster。</p> <p>（9）Container 从HDFS 上拷贝资源到本地。</p> <p>（10）MRAppmaster 向RM 申请运行 MapTask 资源。</p> <p>（11） RM 将运行 MapTask 任务分配给另外两个 NodeManager， 另两个NodeManager 分别领取任务并创建容器。</p> <p>（12）MR 向两个接收到任务的NodeManager 发送程序启动脚本，这两个NodeManager分别启动MapTask，MapTask 对数据分区排序。</p> <p>（13） MrAppMaster 等待所有MapTask 运行完毕后，向RM 申请容器， 运行ReduceTask。</p> <p>（14）ReduceTask 向MapTask 获取相应分区的数据。</p> <p>（15）程序运行完毕后，MR 会向RM 申请注销自己。</p> <h2 id="_1-3-作业提交全过程"><a href="#_1-3-作业提交全过程" class="header-anchor">#</a> 1.3 作业提交全过程</h2> <p><strong>HDFS、YARN、MapReduce三者关系</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242110831.png" alt="image-20250224211054799"></p> <p><strong>作业提交过程之YARN</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242111184.png" alt="image-20250224211123152"></p> <p><strong>作业提交过程之HDFS &amp; MapReduce</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242111916.png" alt="image-20250224211150880"></p> <p>作业提交全过程详解</p> <p>（1）作业提交</p> <p>第 1 步：Client 调用job.waitForCompletion 方法，向整个集群提交 MapReduce 作业。</p> <p>第 2 步：Client 向RM 申请一个作业 id。</p> <p>第 3 步：RM 给 Client 返回该job 资源的提交路径和作业id。</p> <p>第 4 步：Client 提交jar 包、切片信息和配置文件到指定的资源提交路径。</p> <p>第 5 步：Client 提交完资源后，向RM 申请运行MrAppMaster。</p> <p>（2）作业初始化</p> <p>第 6 步：当 RM 收到Client 的请求后，将该job 添加到容量调度器中。</p> <p>第 7 步：某一个空闲的NM 领取到该 Job。</p> <p>第 8 步：该 NM 创建 Container，并产生 MRAppmaster。</p> <p>第 9 步：下载Client 提交的资源到本地。</p> <p>（3）任务分配</p> <p>第 10 步：MrAppMaster 向 RM 申请运行多个MapTask 任务资源。</p> <p>第 11 步： RM 将运行MapTask 任务分配给另外两个NodeManager， 另两个NodeManager分别领取任务并创建容器。</p> <p>（4）任务运行</p> <p>第 12 步：MR 向两个接收到任务的 NodeManager 发送程序启动脚本，这两个NodeManager 分别启动 MapTask，MapTask 对数据分区排序。</p> <p>第13 步： MrAppMaster 等待所有MapTask 运行完毕后，向RM 申请容器， 运行ReduceTask。</p> <p>第 14 步：ReduceTask 向MapTask 获取相应分区的数据。</p> <p>第 15 步：程序运行完毕后，MR 会向 RM 申请注销自己。</p> <p>（5）进度和状态更新</p> <p>YARN 中的任务将其进度和状态(包括 counter)返回给应用管理器, 客户端每秒(通过mapreduce.client.progressmonitor.pollinterval 设置)向应用管理器请求进度更新, 展示给用户。</p> <p>（6）作业完成</p> <p>除了向应用管理器请求作业进度外, 客户端每 5 秒都会通过调用 waitForCompletion()来检查作业是否完成。时间间隔可以通过mapreduce.client.completion.pollinterval 来设置。作业完成之后, 应用管理器和 Container 会清理工作状态。作业的信息会被作业历史服务器存储以备之后用户核查。</p> <h2 id="_1-4-yarn-调度器和调度算法"><a href="#_1-4-yarn-调度器和调度算法" class="header-anchor">#</a> 1.4 Yarn 调度器和调度算法</h2> <p>目前，Hadoop 作业调度器主要有三种：FIFO、容量（Capacity Scheduler）和公平（Fair Scheduler）。Apache Hadoop3.1.3 默认的资源调度器是 Capacity Scheduler。</p> <p>CDH 框架默认调度器是Fair Scheduler。</p> <p>具体设置详见：yarn-default.xml 文件</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The class to use as the resource scheduler.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_1-4-1-先进先出调度器-fifo"><a href="#_1-4-1-先进先出调度器-fifo" class="header-anchor">#</a> 1.4.1 先进先出调度器（<strong>FIFO</strong>）</h3> <p>FIFO 调度器（First In First Out）：单队列，根据提交作业的先后顺序，先来先服务。</p> <p><strong>FIFO调度器</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242114956.png" alt="image-20250224211428923"></p> <p>优点：简单易懂；</p> <p>缺点：不支持多队列，生产环境很少使用；</p> <h3 id="_1-4-2-容量调度器-capacity-scheduler"><a href="#_1-4-2-容量调度器-capacity-scheduler" class="header-anchor">#</a> 1.4.2 容量调度器（<strong>Capacity Scheduler</strong>）</h3> <p>Capacity Scheduler 是Yahoo 开发的多用户调度器。</p> <p><strong>容量调度器特点</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242115694.png" alt="image-20250224211522658"></p> <p>1、多队列：每个队列可配置一定的资源量，每个队列采用FIFO调度策略。</p> <p>2、容量保证：管理员可为每个队列设置资源最低保证和资源使用上限</p> <p>3、灵活性：如果一个队列中的资源有剩余，可以暂时共享给那些需要资源的队列，而一旦该队列有新的应用程序提交，则其他队列借调的资源会归还给该队列。</p> <p>4、多租户：</p> <p>支持多用户共享集群和多应用程序同时运行。</p> <p>为了防止同一个用户的作业独占队列中的资源，该调度器会对同一用户提交的作业所占资源量进行限定。</p> <p><strong>容量调度器资源分配算法</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242116256.png" alt="image-20250224211613223"></p> <h3 id="_1-4-3-公平调度器-fair-scheduler"><a href="#_1-4-3-公平调度器-fair-scheduler" class="header-anchor">#</a> 1.4.3 公平调度器（<strong>Fair Scheduler</strong>）</h3> <p>Fair Schedulere 是Facebook 开发的多用户调度器。</p> <p><strong>公平调度器特点</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242117472.png" alt="image-20250224211702432"></p> <p><strong>1</strong>）与容量调度器相同点</p> <p>（1）多队列：支持多队列多作业</p> <p>（2）容量保证：管理员可为每个队列设置资源最低保证和资源使用上线</p> <p>（3）灵活性：如果一个队列中的资源有剩余，可以暂时共享给那些需要资源的队列，而一旦该队列有新的应用程序提交，则其他队列借调的资源会归还给该队列。</p> <p>（4）多租户：支持多用户共享集群和多应用程序同时运行；为了防止同一个用户的作业独占队列中的资源，该调度器会对同一用户提交的作业所占资源量进行限定。</p> <p><strong>2</strong>）与容量调度器不同点</p> <p>（1）核心调度策略不同</p> <p>容量调度器：优先选择资源利用率低的队列</p> <p>公平调度器：优先选择对资源的缺额比例大的</p> <p>（2）每个队列可以单独设置资源分配方式</p> <p>容量调度器：FIFO、 DRF</p> <p>公平调度器：FIFO、FAIR、DRF</p> <p><strong>公平调度器——缺额</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242118376.png" alt="image-20250224211817343"></p> <ul><li>公平调度器设计目标是：在时间尺度上，所有作业获得公平的资源。某一时刻一个作业应获资源和实际获取资源的差距叫“缺额”</li> <li>调度器会优先为缺额大的作业分配资源</li></ul> <p><strong>公平调度器队列资源分配方式</strong></p> <p><strong>1</strong>）<strong>FIFO</strong>策略</p> <p>公平调度器每个队列资源分配策略如果选择FIFO的话，此时公平调度器相当于上面讲过的容量调度器。</p> <p><strong>2</strong>）<strong>Fair</strong>策略</p> <p>Fair 策略（默认）是一种基于最大最小公平算法实现的资源多路复用方式，默认情况下，每个队列内部采用该方式分配资源。这意味着，如果一个队列中有两个应用程序同时运行，则每个应用程序可得到1/2的资源；如果三个应用程序同时运行，则每个应用程序可得到1/3的资源。</p> <p>具体资源分配流程和容量调度器一致；</p> <p>（1）选择队列</p> <p>（2）选择作业</p> <p>（3）选择容器</p> <p>以上三步，每一步都是按照公平策略分配资源</p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242120975.png" alt="image-20250224212000938"></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242121935.png" alt="image-20250224212118895"></p> <p><strong>公平调度器资源分配算法</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242121382.png" alt="image-20250224212157349"></p> <p><strong>公平调度器队列资源分配方式</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242122285.png" alt="image-20250224212226246"></p> <p><strong>3</strong>）<strong>DRF</strong>策略</p> <p>DRF（Dominant Resource Fairness），我们之前说的资源，都是单一标准，例如只考虑内存（也是Yarn默认的情况）。但是很多时候我们资源有很多种，例如内存，CPU，网络带宽等，这样我们很难衡量两个应用应该分配的资源比例。</p> <p>那么在YARN中，我们用DRF来决定如何调度：</p> <p>假设集群一共有100 CPU和10T 内存，而应用A需要（2 CPU, 300GB），应用B需要（6 CPU，100GB）。则两个应用分别需要A（2%CPU, 3%内存）和B（6%CPU, 1%内存）的资源，这就意味着A是内存主导的, B是CPU主导的，针对这种情况，我们可以选择DRF策略对不同应用进行不同资源（CPU和内存）的一个不同比例的限制。</p> <h2 id="_1-5-yarn-常用命令"><a href="#_1-5-yarn-常用命令" class="header-anchor">#</a> 1.5 Yarn 常用命令</h2> <p>Yarn 状态的查询，除了可以在 hadoop103:8088 页面查看外，还可以通过命令操作。常见的命令操作如下所示：</p> <p>需求：执行 WordCount 案例，并用Yarn 命令查看任务运行情况。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ myhadoop.sh start
<span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount /input /output
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_1-5-1-yarn-application-查看任务"><a href="#_1-5-1-yarn-application-查看任务" class="header-anchor">#</a> 1.5.1 yarn application 查看任务</h3> <p>（1）列出所有Application：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> application <span class="token parameter variable">-list</span>
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:21:19,238 INFO client.RMProxy: Connecting to ResourceManager at hadoop103/192.168.10.103:8032
Total number of applications <span class="token punctuation">(</span>application-types: <span class="token punctuation">[</span><span class="token punctuation">]</span>, states: <span class="token punctuation">[</span>SUBMITTED,ACCEPTED, RUNNING<span class="token punctuation">]</span> and tags: <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>:0
Application-Id Application-Name Application-Type User Queue State Final-State Progress Tracking-URL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>（2）根据Application 状态过滤：yarn application -list -appStates （所有状态：ALL、NEW、NEW_SAVING、SUBMITTED、ACCEPTED、RUNNING、FINISHED、FAILED、KILLED）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> application <span class="token parameter variable">-list</span> <span class="token parameter variable">-appStates</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>FINISHED <span class="token number">2021</span>-02-06 <span class="token number">10</span>:22:20,029 INFO client.RMProxy: Connecting to ResourceManager at hadoop103/192.168.10.103:8032
Total number of applications <span class="token punctuation">(</span>application-types: <span class="token punctuation">[</span><span class="token punctuation">]</span>, states: <span class="token punctuation">[</span>FINISHED<span class="token punctuation">]</span> and tags: <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>:1
Application-Id Application-Name Application-Type User Queue State Final-State Progress
Tracking-URL application_1612577921195_0001 word count MAPREDUCE
atguigu default FINISHED SUCCEEDED <span class="token number">100</span>%
http://hadoop102:19888/jobhistory/job/job_1612577921195_0001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>（3）Kill 掉Application：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> application <span class="token parameter variable">-kill</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>application_1612577921195_0001
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:23:48,530 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Application application_1612577921195_0001 has already finished
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_1-5-2-yarn-logs-查看日志"><a href="#_1-5-2-yarn-logs-查看日志" class="header-anchor">#</a> 1.5.2 yarn logs 查看日志</h3> <p>（1）查询Application 日志：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> logs <span class="token parameter variable">-applicationId</span> <span class="token operator">&lt;</span>ApplicationId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> logs <span class="token parameter variable">-applicationId</span> application_1612577921195_0001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>（2）查询Container 日志：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> logs <span class="token parameter variable">-applicationId</span> <span class="token operator">&lt;</span>ApplicationId<span class="token operator">&gt;</span> <span class="token parameter variable">-containerId</span> <span class="token operator">&lt;</span>ContainerId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> logs <span class="token parameter variable">-applicationId</span> application_1612577921195_0001 <span class="token parameter variable">-containerId</span>
container_1612577921195_0001_01_000001
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_1-5-3-yarn-applicationattempt-查看尝试运行的任务"><a href="#_1-5-3-yarn-applicationattempt-查看尝试运行的任务" class="header-anchor">#</a> 1.5.3 yarn applicationattempt 查看尝试运行的任务</h3> <p>（1）列出所有Application 尝试的列表：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> applicationattempt <span class="token parameter variable">-list</span> <span class="token operator">&lt;</span>ApplicationId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> applicationattempt <span class="token parameter variable">-list</span>
application_1612577921195_0001
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:26:54,195 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Total number of application attempts :1
ApplicationAttempt-Id State AM-
Container-Id Tracking-URL
appattempt_1612577921195_0001_000001 FINISHED
container_1612577921195_0001_01_000001
http://hadoop103:8088/proxy/application_1612577921195_0001/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>（2） 打印ApplicationAttemp 状态：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token function">yarn</span> applicationattempt <span class="token parameter variable">-status</span> <span class="token operator">&lt;</span>ApplicationAttemptId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> applicationattempt <span class="token parameter variable">-status</span>
appattempt_1612577921195_0001_000001
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:27:55,896 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Application Attempt Report <span class="token builtin class-name">:</span>
ApplicationAttempt-Id <span class="token builtin class-name">:</span> appattempt_1612577921195_0001_000001
State <span class="token builtin class-name">:</span> FINISHED
AMContainer <span class="token builtin class-name">:</span> container_1612577921195_0001_01_000001
Tracking-URL <span class="token builtin class-name">:</span>
http://hadoop103:8088/proxy/application_1612577921195_0001/
RPC Port <span class="token builtin class-name">:</span> <span class="token number">34756</span>
AM Host <span class="token builtin class-name">:</span> hadoop104
Diagnostics <span class="token builtin class-name">:</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_1-5-4-yarn-container-查看容器"><a href="#_1-5-4-yarn-container-查看容器" class="header-anchor">#</a> 1.5.4 yarn container 查看容器</h3> <p>（1）列出所有Container：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> container <span class="token parameter variable">-list</span> <span class="token operator">&lt;</span>ApplicationAttemptId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> container <span class="token parameter variable">-list</span>
appattempt_1612577921195_0001_000001
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:28:41,396 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Total number of containers :0
Container-Id Start Time Finish Time
State Host Node Http Address
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>（2）打印Container 状态：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> container <span class="token parameter variable">-status</span> <span class="token operator">&lt;</span>ContainerId<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> container <span class="token parameter variable">-status</span>
container_1612577921195_0001_01_000001
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:29:58,554 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Container with <span class="token function">id</span> <span class="token string">'container_1612577921195_0001_01_000001'</span> doesn't exist
<span class="token keyword">in</span> RM or Timeline Server.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>注：只有在任务跑的途中才能看到 container 的状态</p> <h3 id="_1-5-5-yarn-node-查看节点状态"><a href="#_1-5-5-yarn-node-查看节点状态" class="header-anchor">#</a> 1.5.5 yarn node 查看节点状态</h3> <p>列出所有节点：yarn node -list -all</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> <span class="token function">node</span> <span class="token parameter variable">-list</span> <span class="token parameter variable">-all</span>
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:31:36,962 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Total Nodes:3
Node-Id Node-State Node-Http-Address Number-of-Running-
Containers
hadoop103:38168 RUNNING hadoop103:8042
<span class="token number">0</span>
hadoop102:42012 RUNNING hadoop102:8042
<span class="token number">0</span>
hadoop104:39702 RUNNING hadoop104:8042
<span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_1-5-6-yarn-rmadmin-更新配置"><a href="#_1-5-6-yarn-rmadmin-更新配置" class="header-anchor">#</a> 1.5.6 yarn rmadmin 更新配置</h3> <p>加载队列配置：yarn rmadmin -refreshQueues</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> rmadmin <span class="token parameter variable">-refreshQueues</span>
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:32:03,331 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8033
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_1-5-7-yarn-queue-查看队列"><a href="#_1-5-7-yarn-queue-查看队列" class="header-anchor">#</a> 1.5.7 yarn queue 查看队列</h3> <p>打印队列信息：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> queue <span class="token parameter variable">-status</span> <span class="token operator">&lt;</span>QueueName<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> queue <span class="token parameter variable">-status</span> default
<span class="token number">2021</span>-02-06 <span class="token number">10</span>:32:33,403 INFO client.RMProxy: Connecting to ResourceManager
at hadoop103/192.168.10.103:8032
Queue Information <span class="token builtin class-name">:</span>
Queue Name <span class="token builtin class-name">:</span> default
State <span class="token builtin class-name">:</span> RUNNING
Capacity <span class="token builtin class-name">:</span> <span class="token number">100.0</span>%
Current Capacity <span class="token builtin class-name">:</span> .0%
Maximum Capacity <span class="token builtin class-name">:</span> <span class="token number">100.0</span>%
Default Node Label expression <span class="token builtin class-name">:</span> <span class="token operator">&lt;</span>DEFAULT_PARTITION<span class="token operator">&gt;</span>
Accessible Node Labels <span class="token builtin class-name">:</span> *
Preemption <span class="token builtin class-name">:</span> disabled
Intra-queue Preemption <span class="token builtin class-name">:</span> disabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_1-6-yarn-生产环境核心参数"><a href="#_1-6-yarn-生产环境核心参数" class="header-anchor">#</a> 1.6 Yarn 生产环境核心参数</h2> <p><strong>YARN生产环境核心参数</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242133744.png" alt="image-20250224213315704"></p> <h1 id="第-2-章-yarn-案例实操"><a href="#第-2-章-yarn-案例实操" class="header-anchor">#</a> 第 2 章 Yarn 案例实操</h1> <p>注：调整下列参数之前尽量拍摄 Linux 快照，否则后续的案例，还需要重写准备集群。</p> <h2 id="_2-1-yarn-生产环境核心参数配置案例"><a href="#_2-1-yarn-生产环境核心参数配置案例" class="header-anchor">#</a> 2.1 Yarn 生产环境核心参数配置案例</h2> <p>1）需求：从 1G 数据中，统计每个单词出现次数。服务器 3 台，每台配置 4G 内存，4 核</p> <p>CPU，4 线程。</p> <p>2）需求分析：</p> <p>1G / 128m = 8 个 MapTask；1 个ReduceTask；1 个mrAppMaster</p> <p>平均每个节点运行 10 个 / 3 台 ≈ 3 个任务（4 3 3）</p> <p>3）修改yarn-site.xml 配置参数如下：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 选择调度器，默认容量 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The class to use as the resource scheduler.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- ResourceManager处理调度器请求的线程数量,默认 50；如果提交的任务数大于 50，可以
增加该值，但是不能超过 3台 * 4线程 = 12线程（去除其他应用程序实际不能超过 8） --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Number of threads to handle scheduler interface.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.client.thread-count<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 是否让 yarn自动检测硬件进行配置，默认是 false，如果该节点有很多其他应用程序，建议
手动配置。如果该节点没有其他应用程序，可以采用自动 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Enable auto-detection of node capabilities such as memory and CPU.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.detect-hardware-capabilities<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 是否将虚拟核数当作 CPU核数，默认是 false，采用物理 CPU核数 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Flag to determine if logical processors(such as hyperthreads) should be counted as cores. Only applicable on Linux when yarn.nodemanager.resource.cpu-vcores is set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.count-logical-processors-as-cores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 虚拟核数和物理核数乘数，默认是 1.0 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Multiplier to determine how to convert phyiscal cores to vcores. This value is used if yarn.nodemanager.resource.cpu-vcores is set to -1(which implies auto-calculate vcores) and yarn.nodemanager.resource.detect-hardware-capabilities is set to true. The number of vcores will be calculated as number of CPUs * multiplier.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.pcores-vcores-multiplier<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- NodeManager使用内存数，默认 8G，修改为 4G内存 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Amount of physical memory, in MB, that can be allocated for containers. If set to -1 and
    yarn.nodemanager.resource.detect-hardware-capabilities is true, it is automatically calculated(in case of Windows and Linux). In other cases, the default is 8192MB.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.memory-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>4096<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- nodemanager的 CPU核数，不按照硬件环境自动设定时默认是 8个，修改为 4个 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Number of vcores that can be allocated for containers. This is used by the RM scheduler when allocating resources for containers. This is not used to limit the number of CPUs used by YARN containers. If it is set to -1 and yarn.nodemanager.resource.detect-hardware-capabilities is true, it is automatically determined from the hardware in case of Windows and Linux. In other cases, number of vcores is 8 by default.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.resource.cpu-vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 容器最小内存，默认 1G --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The minimum allocation for every container request at the RM in MBs. Memory requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have
    less memory than this value will be shut down by the resource manager.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.minimum-allocation-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1024<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 容器最大内存，默认 8G，修改为 2G --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The maximum allocation for every container request at the RM in MBs. Memory requests higher than this will throw an InvalidResourceRequestException.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.maximum-allocation-mb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2048<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 容器最小 CPU核数，默认 1个 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The minimum allocation for every container request at the RM in terms of virtual CPU cores. Requests lower than this will be set to the value of this property. Additionally, a node manager that is configured to have fewer virtual cores than this value will be shut down by the
    resource manager.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.minimum-allocation-vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 容器最大 CPU核数，默认 4个，修改为 2个 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The maximum allocation for every container request at the RM in terms of virtual CPU cores. Requests higher than this will throw an InvalidResourceRequestException.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.maximum-allocation-vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 虚拟内存检查，默认打开，修改为关闭 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Whether virtual memory limits will be enforced for containers.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.vmem-check-enabled<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 虚拟内存和物理内存设置比例,默认 2.1 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Ratio between virtual memory to physical memory when setting memory limits for containers. Container allocations are expressed in terms of physical memory, and virtual memory usage is
    allowed to exceed this allocation by this ratio.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.vmem-pmem-ratio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br></div></div><p><strong>关闭虚拟内存检查原因</strong></p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242138329.png" alt="image-20250224213856284"></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Ratio between virtual memory to physical memory when setting memory limits for containers. Container allocations are expressed in terms of physical memory, and virtual memory usage is allowed to exceed this allocation by this ratio.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.vmem-pmem-ratio<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>4）分发配置。</p> <p>注意：如果集群的硬件资源不一致，要每个NodeManager 单独配置</p> <p>5）重启集群</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ sbin/stop-yarn.sh
<span class="token punctuation">[</span>atguigu@hadoop103 hadoop-3.1.3<span class="token punctuation">]</span>$ sbin/start-yarn.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>6）执行WordCount 程序</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount /input /output
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>7）观察Yarn 任务执行页面</p> <p>http://hadoop103:8088/cluster/apps</p> <h2 id="_2-2-容量调度器多队列提交案例"><a href="#_2-2-容量调度器多队列提交案例" class="header-anchor">#</a> 2.2 容量调度器多队列提交案例</h2> <p>1）在生产环境怎么创建队列？</p> <p>（1）调度器默认就1 个default 队列，不能满足生产要求。</p> <p>（2）按照框架：hive /spark/ flink 每个框架的任务放入指定的队列（企业用的不是特别多）</p> <p>（3）按照业务模块：登录注册、购物车、下单、业务部门 1、业务部门2</p> <p>2）创建多队列的好处？</p> <p>（1）因为担心员工不小心，写递归死循环代码，把所有资源全部耗尽。</p> <p>（2）实现任务的降级使用，特殊时期保证重要的任务队列资源充足。11.11  6.18</p> <p>业务部门1（重要）=》业务部门2（比较重要）=》下单（一般）=》购物车（一般）=》登录注册（次要）</p> <h3 id="_2-2-1-需求"><a href="#_2-2-1-需求" class="header-anchor">#</a> 2.2.1 需求</h3> <p>需求 1：default 队列占总内存的40%，最大资源容量占总资源 60%，hive 队列占总内存的60%，最大资源容量占总资源80%。</p> <p>需求 2：配置队列优先级</p> <h3 id="_2-2-2-配置多队列的容量调度器"><a href="#_2-2-2-配置多队列的容量调度器" class="header-anchor">#</a> 2.2.2 配置多队列的容量调度器</h3> <p>1）在capacity-scheduler.xml 中配置如下：</p> <p>（1）修改如下配置</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 指定多队列，增加 hive队列 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.queues<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>default,hive<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The queues at the this level (root is the root queue).<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 降低 default队列资源额定容量为 40%，默认 100% --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.default.capacity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>40<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 降低 default队列资源最大容量为 60%，默认 100% --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.default.maximum-capacity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>（2）为新加队列添加必要属性：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 指定 hive队列的资源额定容量 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.capacity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 用户最多可以使用队列多少资源，1表示 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.user-limit-factor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 指定 hive队列的资源最大容量 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.maximum-capacity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>80<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 启动 hive队列 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.state<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>RUNNING<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 哪些用户有权向队列提交作业 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.acl_submit_applications<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 哪些用户有权操作队列，管理员权限（查看/杀死） --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.acl_administer_queue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 哪些用户有权配置提交任务优先级 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.acl_application_max_priority<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 任务的超时时间设置：yarn application -appId appId -updateLifetime Timeout
参 考 资 料 ： https://blog.cloudera.com/enforcing-application-lifetime-slas-
yarn/ --&gt;</span>

<span class="token comment">&lt;!-- 如果 application指定了超时时间，则提交到该队列的 application能够指定的最大超时
时间不能超过该值。
--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.maximum-application-lifetime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 如果 application没指定超时时间，则用 default-application-lifetime作为默认
值 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.capacity.root.hive.default-application-lifetime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>2）分发配置文件</p> <p>3）重启 Yarn 或者执行 yarn rmadmin -refreshQueues 刷新队列，就可以看到两条队列：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> rmadmin <span class="token parameter variable">-refreshQueues</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242145762.png" alt="image-20250224214515712"></p> <h3 id="_2-2-3-向-hive-队列提交任务"><a href="#_2-2-3-向-hive-队列提交任务" class="header-anchor">#</a> 2.2.3 向 Hive 队列提交任务</h3> <p>1）hadoop jar 的方式</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar wordcount <span class="token parameter variable">-Dmapreduce.job.queuename</span><span class="token operator">=</span>hive /input /output
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注: -D 表示运行时改变参数值</p> <p>2）打 jar 包的方式</p> <p>默认的任务提交都是提交到 default 队列的。如果希望向其他队列提交任务，需要在Driver 中声明：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WcDrvier</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Configuration</span> conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;mapreduce.job.queuename&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token comment">//1. 获取一个 Job实例</span>
        <span class="token class-name">Job</span> job <span class="token operator">=</span> <span class="token class-name">Job</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        。。。 。。。
          
        <span class="token comment">//6. 提交 Job</span>
        <span class="token keyword">boolean</span> b <span class="token operator">=</span> job<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>b <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这样，这个任务在集群提交时，就会提交到 hive 队列：</p> <p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242147786.png" alt="image-20250224214721737"></p> <h3 id="_2-2-4-任务优先级"><a href="#_2-2-4-任务优先级" class="header-anchor">#</a> 2.2.4 任务优先级</h3> <p>容量调度器，支持任务优先级的配置，在资源紧张时，优先级高的任务将优先获取资源。默认情况， Yarn 将所有任务的优先级限制为 0，若想使用任务的优先级功能，须开放该限制。</p> <p>1）修改yarn-site.xml 文件，增加以下参数</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.cluster.max-application-priority<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2）分发配置，并重启 Yarn</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop<span class="token punctuation">]</span>$ xsync yarn-site.xml
<span class="token punctuation">[</span>atguigu@hadoop103 hadoop-3.1.3<span class="token punctuation">]</span>$ sbin/stop-yarn.sh
<span class="token punctuation">[</span>atguigu@hadoop103 hadoop-3.1.3<span class="token punctuation">]</span>$ sbin/start-yarn.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3）模拟资源紧张环境，可连续提交以下任务，直到新提交的任务申请不到资源为止。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi <span class="token number">5</span> <span class="token number">2000000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242149811.png" alt="image-20250224214921757"></p> <p>4）再次重新提交优先级高的任务</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi <span class="token parameter variable">-Dmapreduce.job.priority</span><span class="token operator">=</span><span class="token number">5</span> <span class="token number">5</span> <span class="token number">2000000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242150952.png" alt="image-20250224215003896"></p> <p>5）也可以通过以下命令修改正在执行的任务的优先级。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">yarn</span> application <span class="token parameter variable">-appID</span> <span class="token operator">&lt;</span>ApplicationID<span class="token operator">&gt;</span> <span class="token parameter variable">-updatePriority</span> 优先级
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> application <span class="token parameter variable">-appID</span> application_1611133087930_0009 <span class="token parameter variable">-updatePriority</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_2-3-公平调度器案例"><a href="#_2-3-公平调度器案例" class="header-anchor">#</a> 2.3 公平调度器案例</h2> <h3 id="_2-3-1-需求"><a href="#_2-3-1-需求" class="header-anchor">#</a> 2.3.1 需求</h3> <p>创建两个队列，分别是 test 和atguigu（以用户所属组命名）。期望实现以下效果：若用户提交任务时指定队列，则任务提交到指定队列运行；若未指定队列，test 用户提交的任务到root.group.test 队列运行，atguigu 提交的任务到 root.group.atguigu 队列运行（注：group 为用户所属组）。</p> <p>公平调度器的配置涉及到两个文件，一个是 yarn-site.xml，另一个是公平调度器队列分配文件fair-scheduler.xml（文件名可自定义）。</p> <p>（1）配置文件参考资料：</p> <p>https://hadoop.apache.org/docs/r3.1.3/hadoop-yarn/hadoop-yarn-site/FairScheduler.html</p> <p>（2）任务队列放置规则参考资料：</p> <p>https://blog.cloudera.com/untangling-apache-hadoop-yarn-part-4-fair-scheduler-queue-</p> <p>basics/</p> <h3 id="_2-3-2-配置多队列的公平调度器"><a href="#_2-3-2-配置多队列的公平调度器" class="header-anchor">#</a> 2.3.2 配置多队列的公平调度器</h3> <p>1）修改 yarn-site.xml 文件，加入以下参数</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.scheduler.class<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>配置使用公平调度器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.fair.allocation.file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/opt/module/hadoop-3.1.3/etc/hadoop/fair-scheduler.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>指明公平调度器队列分配配置文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.scheduler.fair.preemption<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>禁止队列间资源抢占<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>2）配置 fair-scheduler.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allocations</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 单个队列中 Application Master占用资源的最大比例,取值 0-1 ，企业一般配置 0.1 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queueMaxAMShareDefault</span><span class="token punctuation">&gt;</span></span>0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queueMaxAMShareDefault</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 单个队列最大资源的默认值 test atguigu default --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queueMaxResourcesDefault</span><span class="token punctuation">&gt;</span></span>4096mb,4vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queueMaxResourcesDefault</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token comment">&lt;!-- 增加一个队列 test --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queue</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列最小资源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>minResources</span><span class="token punctuation">&gt;</span></span>2048mb,2vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>minResources</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列最大资源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxResources</span><span class="token punctuation">&gt;</span></span>4096mb,4vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxResources</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列中最多同时运行的应用数，默认 50，根据线程数配置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxRunningApps</span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxRunningApps</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列中 Application Master占用资源的最大比例 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxAMShare</span><span class="token punctuation">&gt;</span></span>0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxAMShare</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 该队列资源权重,默认值为 1.0 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>weight</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>weight</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列内部的资源分配策略 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedulingPolicy</span><span class="token punctuation">&gt;</span></span>fair<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedulingPolicy</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queue</span><span class="token punctuation">&gt;</span></span>
  
<span class="token comment">&lt;!-- 增加一个队列 atguigu --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queue</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>atguigu<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列最小资源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>minResources</span><span class="token punctuation">&gt;</span></span>2048mb,2vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>minResources</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列最大资源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxResources</span><span class="token punctuation">&gt;</span></span>4096mb,4vcores<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxResources</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列中最多同时运行的应用数，默认 50，根据线程数配置 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxRunningApps</span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxRunningApps</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列中 Application Master占用资源的最大比例 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxAMShare</span><span class="token punctuation">&gt;</span></span>0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxAMShare</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 该队列资源权重,默认值为 1.0 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>weight</span><span class="token punctuation">&gt;</span></span>1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>weight</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 队列内部的资源分配策略 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schedulingPolicy</span><span class="token punctuation">&gt;</span></span>fair<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schedulingPolicy</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queue</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token comment">&lt;!-- 任务队列分配策略,可配置多层规则,从第一个规则开始匹配,直到匹配成功 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queuePlacementPolicy</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 提交任务时指定队列,如未指定提交队列,则继续匹配下一个规则; false表示：如果指定队列不存在,不允许自动创建--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>specified<span class="token punctuation">&quot;</span></span> <span class="token attr-name">create</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 提交到 root.group.username队列,若 root.group不存在,不允许自动创建；若root.group.user不存在,允许自动创建 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nestedUserQueue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">create</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primaryGroup<span class="token punctuation">&quot;</span></span> <span class="token attr-name">create</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 最后一个规则必须为 reject或者 default。Reject表示拒绝创建提交失败，default表示把任务提交到 default队列 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reject<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queuePlacementPolicy</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allocations</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>3）分发配置并重启Yarn</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>[atguigu@hadoop102 hadoop]$ xsync yarn-site.xml
[atguigu@hadoop102 hadoop]$ xsync fair-scheduler.xml
[atguigu@hadoop103 hadoop-3.1.3]$ sbin/stop-yarn.sh
[atguigu@hadoop103 hadoop-3.1.3]$ sbin/start-yarn.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-3-3-测试提交任务"><a href="#_2-3-3-测试提交任务" class="header-anchor">#</a> 2.3.3 测试提交任务</h3> <p>1）提交任务时指定队列，按照配置规则，任务会到指定的root.test 队列</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar /opt/module/hadoop-
<span class="token number">3.1</span>.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi -
<span class="token assign-left variable">Dmapreduce.job.queuename</span><span class="token operator">=</span>root.test <span class="token number">1</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242157752.png" alt="image-20250224215735683"></p> <p>2）提交任务时不指定队列，按照配置规则，任务会到 root.atguigu.atguigu 队列</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar /opt/module/hadoop-3.1.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.1.3.jar pi <span class="token number">1</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://raw.githubusercontent.com/onetioner/img/main/PicGo3/202502242158867.png" alt="image-20250224215804809"></p> <h2 id="_2-4-yarn-的-tool-接口案例"><a href="#_2-4-yarn-的-tool-接口案例" class="header-anchor">#</a> 2.4 Yarn 的 <strong>Tool</strong> 接口案例</h2> <p>0）回顾：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ hadoop jar wc.jar com.atguigu.mapreduce.wordcount2.WordCountDriver /input
/output1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>期望可以动态传参，结果报错，误认为是第一个输入参数。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>[atguigu@hadoop102 hadoop-3.1.3]$ hadoop jar wc.jar com.atguigu.mapreduce.wordcount2.WordCountDriver -
Dmapreduce.job.queuename=root.test /input /output1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>1）需求：自己写的程序也可以动态修改参数。编写Yarn 的Tool 接口。</p> <p>2）具体步骤：</p> <p>（1）新建Maven 项目YarnDemo，pom 如下：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0
http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>yarn_tool_test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.1.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>（2）新建com.atguigu.yarn 报名</p> <p>（3）创建类 WordCount 并实现Tool 接口：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>yarn</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span></span><span class="token class-name">Path</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IntWritable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">LongWritable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Text</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapreduce<span class="token punctuation">.</span></span><span class="token class-name">Job</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapreduce<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapreduce<span class="token punctuation">.</span></span><span class="token class-name">Reducer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapreduce<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>input<span class="token punctuation">.</span></span><span class="token class-name">FileInputFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>mapreduce<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>output<span class="token punctuation">.</span></span><span class="token class-name">FileOutputFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Tool</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCount</span> <span class="token keyword">implements</span> <span class="token class-name">Tool</span> <span class="token punctuation">{</span>
    
  	<span class="token keyword">private</span> <span class="token class-name">Configuration</span> conf<span class="token punctuation">;</span>
  
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Job</span> job <span class="token operator">=</span> <span class="token class-name">Job</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        job<span class="token punctuation">.</span><span class="token function">setJarByClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountDriver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        job<span class="token punctuation">.</span><span class="token function">setMapperClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setReducerClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountReducer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        job<span class="token punctuation">.</span><span class="token function">setMapOutputKeyClass</span><span class="token punctuation">(</span><span class="token class-name">Text</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setMapOutputValueClass</span><span class="token punctuation">(</span><span class="token class-name">IntWritable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setOutputKeyClass</span><span class="token punctuation">(</span><span class="token class-name">Text</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setOutputValueClass</span><span class="token punctuation">(</span><span class="token class-name">IntWritable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token class-name">FileInputFormat</span><span class="token punctuation">.</span><span class="token function">setInputPaths</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputFormat</span><span class="token punctuation">.</span><span class="token function">setOutputPath</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token keyword">return</span> job<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setConf</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> conf<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token keyword">this</span><span class="token punctuation">.</span>conf <span class="token operator">=</span> conf<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Configuration</span> <span class="token function">getConf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    		<span class="token keyword">return</span> conf<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">WordCountMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LongWritable</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
      
        <span class="token keyword">private</span> <span class="token class-name">Text</span> outK <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">IntWritable</span> outV <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">LongWritable</span> key<span class="token punctuation">,</span> <span class="token class-name">Text</span> value<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
          
            <span class="token class-name">String</span> line <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> line<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            		outK<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
              
            		context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>outK<span class="token punctuation">,</span> outV<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">WordCountReducer</span> <span class="token keyword">extends</span> <span class="token class-name">Reducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span><span class="token punctuation">,</span><span class="token class-name">IntWritable</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">IntWritable</span> outV <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">Text</span> key<span class="token punctuation">,</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> values<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
          
            <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">IntWritable</span> value <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            		sum <span class="token operator">+=</span> value<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            outV<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
          
            context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> outV<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br></div></div><p>（4）新建WordCountDriver</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>yarn</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Tool</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ToolRunner</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCountDriver</span> <span class="token punctuation">{</span>
  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Tool</span> tool<span class="token punctuation">;</span>
  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1. 创建配置文件</span>
        <span class="token class-name">Configuration</span> conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token comment">// 2. 判断是否有tool接口</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        		<span class="token keyword">case</span> <span class="token string">&quot;wordcount&quot;</span><span class="token operator">:</span>
        				tool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        				<span class="token keyword">break</span><span class="token punctuation">;</span>
        		<span class="token keyword">default</span><span class="token operator">:</span>
        				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot; No such tool: &quot;</span><span class="token operator">+</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 3. 用Tool执行程序</span>
        <span class="token comment">// Arrays.copyOfRange 将老数组的元素放到新数组里面</span>
        <span class="token keyword">int</span> run <span class="token operator">=</span> <span class="token class-name">ToolRunner</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>conf<span class="token punctuation">,</span> tool<span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>3）在HDFS 上准备输入文件，假设为/input 目录，向集群提交该 Jar 包</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> jar YarnDemo.jar com.atguigu.yarn.WordCountDriver wordcount /input /output
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>注意此时提交的 3 个参数，第一个用于生成特定的Tool，第二个和第三个为输入输出目录。此时如果我们希望加入设置参数，可以在 wordcount 后面添加参数，例如：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>atguigu@hadoop102 hadoop-3.1.3<span class="token punctuation">]</span>$ <span class="token function">yarn</span> jar YarnDemo.jar com.atguigu.yarn.WordCountDriver wordcount <span class="token parameter variable">-Dmapreduce.job.queuename</span><span class="token operator">=</span>root.test /input /output1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>4）注：以上操作全部做完过后，快照回去或者手动将配置文件修改成之前的状态，因为本身资源就不够，分成了这么多，不方便以后测试。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing/edit/master/docs/《Hadoop》笔记/05.05-尚硅谷大数据技术之Hadoop（Yarn）V3.3.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/02/25, 13:04:06</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/vuepress-tion-blog/pages/f16deb/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">04-大数据技术之Hadoop（MapReduce）V3.3</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vuepress-tion-blog/pages/f16deb/" class="prev">04-大数据技术之Hadoop（MapReduce）V3.3</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/vuepress-tion-blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vuepress-tion-blog/pages/fc670b/"><div>
            Linux实用操作
            <!----></div></a> <span class="date">02-22</span></dt></dl><dl><dd>02</dd> <dt><a href="/vuepress-tion-blog/pages/bdd22a/"><div>
            用户和权限
            <!----></div></a> <span class="date">02-22</span></dt></dl><dl><dd>03</dd> <dt><a href="/vuepress-tion-blog/pages/98eb94/"><div>
            Linux基础命令
            <!----></div></a> <span class="date">02-20</span></dt></dl> <dl><dd></dd> <dt><a href="/vuepress-tion-blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xugaoyi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2025
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a> | <a href="http://beian.miit.gov.cn/" target="_blank">桂ICP备2024034950号</a> | <img src="/img/beian.png" style="width: 15px; margin-bottom: -3px;" /> <a href="https://beian.mps.gov.cn/#/query/webSearch?code=45142202000030" rel="noreferrer" target="_blank">桂公网安备45142202000030</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/vuepress-tion-blog/assets/js/app.985e0c44.js" defer></script><script src="/vuepress-tion-blog/assets/js/2.1e9277be.js" defer></script><script src="/vuepress-tion-blog/assets/js/103.9c535674.js" defer></script>
  </body>
</html>
